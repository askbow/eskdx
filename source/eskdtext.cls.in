% Copyright 2006 Konstantin Korikov <lostclus@ua.fm>
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2003/12/01 or later.
%
% This work has the LPPL maintenance status "maintained".
% 
% This Current Maintainer of this work is Konstantin Korikov.
%
% This work consists of all files listed in manifest.txt.
%
m4_ESKDX_INIT
m4_FILE_INIT
\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{eskdtext}[
m4_FILE_ID([[$Date$]]) Textual Documentation]

\newcommand{\ESKD@docfont}{14pt}

\DeclareOption{russian}{\PassOptionsToPackage{\CurrentOption}{eskdlang}}
\DeclareOption{ukrainian}{\PassOptionsToPackage{\CurrentOption}{eskdlang}}
\DeclareOption{koi8-r}{\PassOptionsToPackage{\CurrentOption}{eskdlang}}
\DeclareOption{koi8-u}{\PassOptionsToPackage{\CurrentOption}{eskdlang}}
\DeclareOption{cp1251}{\PassOptionsToPackage{\CurrentOption}{eskdlang}}
\DeclareOption{iso8859-5}{\PassOptionsToPackage{\CurrentOption}{eskdlang}}
\DeclareOption{cp866}{\PassOptionsToPackage{\CurrentOption}{eskdlang}}
\DeclareOption{12pt}{\renewcommand{\ESKD@docfont}{\CurrentOption}}
\DeclareOption{14pt}{\renewcommand{\ESKD@docfont}{\CurrentOption}}
\DeclareOption{pointsingle}{\PassOptionsToPackage{\CurrentOption}{eskdsect}}
\DeclareOption{pointsection}{\PassOptionsToPackage{\CurrentOption}{eskdsect}}
\DeclareOption{pointsubsection}{\PassOptionsToPackage{\CurrentOption}{eskdsect}}
\DeclareOption{twoside}{%
  \PassOptionsToClass{\CurrentOption}{extarticle}%
  \PassOptionsToPackage{\CurrentOption}{eskdstamp}}
\DeclareOption{draft}{\PassOptionsToClass{\CurrentOption}{extarticle}}
\DeclareOption{formI}{%
  \ClassError{eskdtext}{formI style is for graphical documentaion}{}}
\DeclareOption{zonelabels}{%
  \ClassError{eskdtext}{Zone labels is not allowed for textual documentaion}{}}
\DeclareOption*{\PassOptionsToPackage{\CurrentOption}{eskdstamp}}

\ProcessOptions\relax

\LoadClass[\ESKD@docfont]{extarticle}
\RequirePackage{eskdlang}
\RequirePackage[a4paper,formII]{eskdstamp}
\RequirePackage{eskdindent}
\RequirePackage{eskdlist}
\RequirePackage{eskdsect}
\RequirePackage{eskdcap}
\RequirePackage{eskdexplan}
\RequirePackage{eskdtitle}

m4_dnl межстрочный интервал
\linespread{1.25}

m4_dnl ведомство
\newcommand{\ESKDtheDepartment}{}
\newcommand{\ESKDdepartment}[1]{\renewcommand{\ESKDtheDepartment}{#1}}

m4_dnl предприятие
\newcommand{\ESKDtheCompany}{}
\newcommand{\ESKDcompany}[1]{\renewcommand{\ESKDtheCompany}{#1}}

m4_dnl код по классификатору продукции
\newcommand{\ESKDtheClassCode}{}
\newcommand{\ESKDclassCode}[1]{\renewcommand{\ESKDtheClassCode}{#1}}

m4_dnl наименование изделия/тема
\newcommand{\ESKDtheTitle}{}
\newcommand{\ESKDtitle}[1]{%
  \renewcommand{\ESKDtheTitle}{#1}%
  \def\@title{#1}}
\renewcommand{\title}[1]{\ESKDtitle{#1}}

m4_dnl название документа
\newcommand{\ESKDtheDocName}{}
\newcommand{\ESKDdocName}[1]{\renewcommand{\ESKDtheDocName}{#1}}

m4_dnl обозначение документа
\newcommand{\ESKDtheSignature}{}
\newcommand{\ESKDsignature}[1]{\renewcommand{\ESKDtheSignature}{#1}}

m4_dnl группа, индекс, или наименование предприятия
\newcommand{\ESKDtheGroup}{}
\newcommand{\ESKDgroup}[1]{\renewcommand{\ESKDtheGroup}{#1}}

m4_dnl фамилия автора
\newcommand{\ESKDtheAuthor}{}
\newcommand{\ESKDauthor}[1]{%
  \renewcommand{\ESKDtheAuthor}{#1}%
  \renewcommand{\@author}{#1}}
\renewcommand{\author}[1]{\ESKDauthor{#1}}

m4_dnl фамилия проверяющего
\newcommand{\ESKDtheChecker}{}
\newcommand{\ESKDchecker}[1]{\renewcommand{\ESKDtheChecker}{#1}}

m4_dnl фамилия нормоконтролера
\newcommand{\ESKDtheNormContr}{}
\newcommand{\ESKDnormContr}[1]{\renewcommand{\ESKDtheNormContr}{#1}}

m4_dnl фамилия утвердившего
\newcommand{\ESKDtheApprovedBy}{}
\newcommand{\ESKDapprovedBy}[1]{\renewcommand{\ESKDtheApprovedBy}{#1}}

m4_dnl дата
\newcommand{\ESKDtheYear}{\number\year}
\newcommand{\ESKDtheMonth}{\number\month}
\newcommand{\ESKDtheDay}{\number\day}
\def\ESKD@set@date#1/#2/#3 enddate{%
  \renewcommand{\ESKDtheYear}{#1}%
  \renewcommand{\ESKDtheMonth}{#2}%
  \renewcommand{\ESKDtheDay}{#3}}
\newcommand{\ESKDdate}[1]{%
  \ESKD@set@date #1 enddate}

\ESKDcolumnI{\ESKDtheTitle\par\ESKDtheDocName}
\ESKDcolumnII{\ESKDtheSignature}
\ESKDcolumnIX{\ESKDtheGroup}
\ESKDcolumnXIfI{\ESKDtheAuthor}
\ESKDcolumnXIfII{\ESKDtheChecker}
\ESKDcolumnXIfV{\ESKDtheNormContr}
\ESKDcolumnXIfVI{\ESKDtheApprovedBy}

\RequirePackage{eskdtitlebase}
\RequirePackage{eskdtitle}

m4_dnl \RequirePackage{eskdaddtopkg}
m4_dnl настройки пакета hyperref
m4_dnl \ESKDaddToPackage{hyperref}{%
m4_dnl \hypersetup{breaklinks,pdftitle=\ESKDtheDocName,%
m4_dnl pdfsubject=\ESKDtheTitle,pdfauthor=\ESKDtheAuthor}}

m4_dnl vim:ft=tex:ai:sw=2
